from neural_network import NeuralNetwork
from activation import Sigmoid


def demo():
    # Teach network symmetry detecting function
    pat = [
        [[0, 0, 0, 0, 0, 0], [1]],
        [[0, 0, 0, 0, 0, 1], [0]],
        [[0, 0, 0, 0, 1, 0], [0]],
        [[0, 0, 0, 0, 1, 1], [0]],
        [[0, 0, 0, 1, 0, 0], [0]],
        [[0, 0, 0, 1, 0, 1], [0]],
        [[0, 0, 0, 1, 1, 0], [0]],
        [[0, 0, 0, 1, 1, 1], [0]],
        [[0, 0, 1, 0, 0, 0], [0]],
        [[0, 0, 1, 0, 0, 1], [0]],
        [[0, 0, 1, 0, 1, 0], [0]],
        [[0, 0, 1, 0, 1, 1], [0]],
        [[0, 0, 1, 1, 0, 0], [1]],
        [[0, 0, 1, 1, 0, 1], [0]],
        [[0, 0, 1, 1, 1, 0], [0]],
        [[0, 0, 1, 1, 1, 1], [0]],
        [[0, 1, 0, 0, 0, 0], [0]],
        [[0, 1, 0, 0, 0, 1], [0]],
        [[0, 1, 0, 0, 1, 0], [1]],
        [[0, 1, 0, 0, 1, 1], [0]],
        [[0, 1, 0, 1, 0, 0], [0]],
        [[0, 1, 0, 1, 0, 1], [0]],
        [[0, 1, 0, 1, 1, 0], [0]],
        [[0, 1, 0, 1, 1, 1], [0]],
        [[0, 1, 1, 0, 0, 0], [0]],
        [[0, 1, 1, 0, 0, 1], [0]],
        [[0, 1, 1, 0, 1, 0], [0]],
        [[0, 1, 1, 0, 1, 1], [0]],
        [[0, 1, 1, 1, 0, 0], [0]],
        [[0, 1, 1, 1, 0, 1], [0]],
        [[0, 1, 1, 1, 1, 0], [1]],
        [[0, 1, 1, 1, 1, 1], [0]],
        [[1, 0, 0, 0, 0, 0], [0]],
        [[1, 0, 0, 0, 0, 1], [1]],
        [[1, 0, 0, 0, 1, 0], [0]],
        [[1, 0, 0, 0, 1, 1], [0]],
        [[1, 0, 0, 1, 0, 0], [0]],
        [[1, 0, 0, 1, 0, 1], [0]],
        [[1, 0, 0, 1, 1, 0], [0]],
        [[1, 0, 0, 1, 1, 1], [0]],
        [[1, 0, 1, 0, 0, 0], [0]],
        [[1, 0, 1, 0, 0, 1], [0]],
        [[1, 0, 1, 0, 1, 0], [0]],
        [[1, 0, 1, 0, 1, 1], [0]],
        [[1, 0, 1, 1, 0, 0], [0]],
        [[1, 0, 1, 1, 0, 1], [1]],
        [[1, 0, 1, 1, 1, 0], [0]],
        [[1, 0, 1, 1, 1, 1], [0]],
        [[1, 1, 0, 0, 0, 0], [0]],
        [[1, 1, 0, 0, 0, 1], [0]],
        [[1, 1, 0, 0, 1, 0], [0]],
        [[1, 1, 0, 0, 1, 1], [1]],
        [[1, 1, 0, 1, 0, 0], [0]],
        [[1, 1, 0, 1, 0, 1], [0]],
        [[1, 1, 0, 1, 1, 0], [0]],
        [[1, 1, 0, 1, 1, 1], [0]],
        [[1, 1, 1, 0, 0, 0], [0]],
        [[1, 1, 1, 0, 0, 1], [0]],
        [[1, 1, 1, 0, 1, 0], [0]],
        [[1, 1, 1, 0, 1, 1], [0]],
        [[1, 1, 1, 1, 0, 0], [0]],
        [[1, 1, 1, 1, 0, 1], [0]],
        [[1, 1, 1, 1, 1, 0], [0]],
        [[1, 1, 1, 1, 1, 1], [1]]
    ]

    # create a network with two input, two hidden, and one output nodes
    n = NeuralNetwork(6, 2, 1, activator=Sigmoid, title='Mirror')
    # train it with some patterns
    # n.activation = tanh
    # n.dactivation = dtanh
    n.train(pat, epoch=100)
    n.print_error(is_graph=True)
    # test it
    n.test(pat)


if __name__ == '__main__':
    demo()
